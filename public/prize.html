<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shiok!</title>
    <link rel="shortcut icon" href="./img/shiokie.png" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css"
    />
    <script
      src="https://kit.fontawesome.com/825a35d965.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="./style/main.css" />
  </head>
  <body>
    <header
      class="flex justify-between px-4 py-2 items-center md:max-w-lg mx-auto bg-slate-200 measure"
    >
      <h1 class="text-xl font-bold">Deals and Rewards</h1>
      <div class="relative">
        <img
          src="./img/acorn-colored.png"
          alt="acorns"
          class="aspect-square absolute w-[40PX] -left-1/2 -top-1/4 rotate-45 translate-x-1/4"
        />
        <p class="rounded-full bg-orange-300/50 px-6" id="acorns">1</p>
      </div>
    </header>
    <div
      class="height container md:max-w-lg mx-auto flex flex-col gap-5 bg-slate-200"
      id="body"
    >
      <div class="mainBG h-full rounded-tl-[25px] rounded-tr-[25px] p-4">
        <div class="flex flex-col gap-3 overflow-y-auto" id="content">
          <div class="flex flex-col py-2">
            <h1 class="text-lg font-bold">Deals Available</h1>
            <!-- <small class="text-xs text-center">&nbsp;</small> -->
          </div>
          <div class="marquee">
            <ul class="marquee__content" id="deals"></ul>
            <ul class="marquee__content" id="deals2"></ul>
          </div>
          <h1 class="text-lg font-bold py-2">Try your luck?</h1>
          <div id="gacha" class="relative w-3/4 md:w-2/3 mx-auto">
            <img src="./img/gachaMachine.png" id="machine" />
            <img src="./img/gachaBall.png" id="balls" class="absolute top-0" />
          </div>
          <button
            type="button"
            class="text-white buttonColor w-full rounded-full p-2 text-center focus:outline-blue-500 focus:outline-2 focus:outline text-xl"
            id="spin"
          >
            <div class="flex gap-2 items-center justify-center w-full">
              <p class="whitespace-nowrap">Spin Now</p>
              <span id="spinCost">10</span>
              <img
                src="./img/acorn-colored.png"
                alt="acorns"
                class="aspect-square w-1/12 rotate-45"
              />
            </div>
          </button>
        </div>
      </div>
    </div>
    <footer
      class="px-2 py-3 w-full md:max-w-lg mx-auto bg-slate-200 fixed md:left-0.5 md:right-0.5 bottom-0 rounded-tl-[25px] rounded-tr-[25px] flex gap-2 justify-evenly measure"
    >
      <a
        class="flex flex-col justify-center h-full aspect-square items-center"
        href="./dashboard.html"
      >
        <img
          class="aspect-square icon mx-auto"
          src="./img/dashboard.png"
          alt=""
        />
        <p class="text-center text-xs font-weight-bold whitespace-normal">
          Dashboard
        </p>
      </a>
      <a
        class="flex flex-col justify-center h-full aspect-square items-center"
        href="./party.html"
      >
        <img class="aspect-square icon mx-auto" src="./img/party.png" alt="" />
        <p class="text-center text-xs font-weight-bold whitespace-normal">
          Party
        </p>
      </a>
      <a
        class="flex flex-col justify-center h-full aspect-square items-center"
        href="./swipe.html"
      >
        <img class="aspect-square icon mx-auto" src="./img/acorn.png" alt="" />
        <p class="text-center text-xs font-weight-bold whitespace-normal">
          Shiok
        </p>
      </a>
      <a
        class="flex flex-col justify-center h-full aspect-square items-center"
        href=""
      >
        <img
          class="aspect-square icon mx-auto"
          src="./img/notification.png"
          alt=""
        />
        <p class="text-center text-xs font-weight-bold whitespace-normal">
          Notification
        </p>
      </a>
      <a
        class="flex flex-col justify-center h-full aspect-square items-center"
        href=""
      >
        <img class="aspect-square icon mx-auto" src="./img/user.png" alt="" />
        <p class="text-center text-xs font-weight-bold whitespace-normal">
          Profile
        </p>
      </a>
    </footer>

    <!-- Gacha -->
    <div
      class="modal hidden fixed top-0 left-0 w-full h-full outline-none fade"
      id="Gacha"
      tabindex="-1"
      role="dialog"
    >
      <div
        class="modal-dialog relative w-auto pointer-events-none max-w-lg my-36 mx-auto px-4 sm:px-0"
        role="document"
      >
        <div
          class="relative flex flex-col w-4/5 mx-auto pointer-events-auto bg-white border border-gray-300 rounded-lg"
        >
          <div
            class="flex items-start justify-end p-4 border-gray-300 rounded-t"
          >
            <h5
              class="mb-0 text-lg leading-normal mx-auto font-bold"
              id="partyCode"
            >
              Congratulations<br />
              Your Prize is ...
            </h5>
            <button type="button" class="close" data-dismiss="modal">
              &times;
            </button>
          </div>
          <div class="relative flex px-4 flex-col pb-4 gap-2">
            <div class="relative">
              <img src="./img/blueBall.gif" id="openBall" />
              <p
                class="absolute top-1/2 left-1/2 -translate-y-1/2 -translate-x-1/2"
                id="prizeValue"
              ></p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>
    <script>
      let vh = 0.01 * window.innerHeight;
      console.log(vh),
        document.documentElement.style.setProperty("--vh", vh + "px");
    </script>
    <script>
      function getAbsoluteHeight(el) {
        // Get the DOM Node if you pass in a string
        el = typeof el === "string" ? document.querySelector(el) : el;

        var styles = window.getComputedStyle(el);
        var margin =
          parseFloat(styles["marginTop"]) + parseFloat(styles["marginBottom"]);

        return Math.ceil(el.offsetHeight + margin);
      }
      var heightSum = 0;
      for (var ele of document.querySelectorAll(".measure")) {
        console.log(ele);
        heightSum += getAbsoluteHeight(ele);
      }
      document.getElementById("body").style.height =
        getAbsoluteHeight(document.getElementById("body")) - heightSum + `px`;
    </script>
    <script>
      var balls = [
        `./img/blueBall.gif`,
        `./img/orangeBall.gif`,
        `./img/redBall.gif`,
      ];

      function genNumber(start, end, int = true) {
        if (int) {
          return Math.floor(Math.random() * end + start);
        }
      }
      var dealsList = [
        "15% off",
        "50% off",
        "$5 off",
        "1 for 1",
        "Free Desert",
        "3 Acorns",
      ];
      var color = ["ff8c3c", "ef3124", "343c76"];
      for (var i = 0; i < dealsList.length; i++) {
        console.log(String(i).length);
        document.getElementById("deals").innerHTML += `
        <li class="marquee__item">
          <div class="aspect-square flex justify-center items-center text-sm p-2 text-white"
          
          style="background: #${color[genNumber(0, color.length)]}">${
          dealsList[i]
        }</div>
        </li>
        `;
        document.getElementById("deals2").innerHTML += `
        <li class="marquee__item">
          <div class="aspect-square flex justify-center items-center text-sm p-2 text-white"
          
          style="background: #${color[genNumber(0, color.length)]}">${
          dealsList[i]
        }</div>
        </li>
        `;
      }
    </script>
    <script>
      function updateAcorns() {
        var acorns = localStorage.getItem("acorns") || 10;
        document.getElementById("acorns").innerHTML = acorns;
      }
      updateAcorns();
    </script>
    <!--gacha Chance-->
    <script>
      document.getElementById("spin").addEventListener("click", () => {
        localStorage.setItem(
          "acorns",
          Number(document.getElementById("acorns").innerHTML) -
            Number(document.getElementById("spinCost").innerHTML)
        );
        document.getElementById(
          "machine"
        ).src = `./img/gachaMachineShaking.gif`;
        document.getElementById("balls").src = `./img/gachaBallShaking.gif`;
        document.getElementById("openBall").src = "";
        setTimeout(() => {
          document.getElementById("machine").src = `./img/gachaMachine.png`;
          document.getElementById("balls").src = `./img/gachaBall.png`;
          document.getElementById("prizeValue").innerHTML = "";
          document.getElementById("openBall").src =
            balls[genNumber(0, balls.length)];
          setTimeout(() => {
            document.getElementById("prizeValue").innerHTML =
              dealsList[genNumber(0, dealsList.length)];
          }, 1000);
          $("#Gacha").modal("show");
        }, 2900);
        updateAcorns();
      });
    </script>
  </body>
</html>
